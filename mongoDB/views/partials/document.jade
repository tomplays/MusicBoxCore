div(class="sections_container")
	h1 {{sectionstocount}}
	welcome {{userin.username}}
	a(ng-click="external_link(root_url+'/auth/facebook')" , ng-if="userin.username == '' ") log in with facebook

	img(ng-src="{{userin.image_url}}")
	section(ng-repeat='section in sorted_sections')
		.cols-edit(ng-include="fragments['section_editor'][0].url" )
		div(ng-repeat='layout in available_layouts')
			div(class="layout_ layout_name_{{layout.name}} has_count_{{section.objects_count.by_positions[layout.name].count}} has_object_{{section.objects_count.by_positions[layout.name].has_object}}")
				// span {{layout.name}}
				// h3 {{section.objects_count.by_positions[layout.name].count}}
				div(ng-if=" (layout.name== 'wide') && ($parent.$index ==0) ")
					h1 {{doc.title}}
				div(ng-if="layout.include_objects !==false")
					div(ng-if="layout.name == 'left'")
							
							.cols-edit(ng-include="fragments['markup_push'][0].url" )

							div(class="markup_ markup_type_inline", ng-repeat="markup in section.objects['markup']['inline']")
								.cols-edit(ng-include="fragments['markup_editor'][0].url" )

					div(ng-repeat='object in available_sections_objects')

						div(class="markup_ markup_type_{{markup.type}}" ng-repeat="markup in section.objects[object][layout.name]")
							.cols-edit(ng-include="fragments['markup_editor'][0].url" )
				// to stay on same indent level
				div
					div(ng-if="layout.name == 'inline'")
						div
							span(ng-class="l.classes" , data-order="{{$index}}" ng-repeat="l in letters[$parent.$parent.$index]") {{l.char}}
footer
	a(href="/doc/{{doc.title}}") permalink
	a(href="/") back home